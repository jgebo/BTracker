
@{
    ViewBag.Title = "ViewsList";
}

<h2>ViewsList</h2>

@* add tables for ticket Comments, Attacments, History *@
<div class="col-md-7 col-md-offset-1">
    <div class="form-group">
        <h4>Ticket Comments</h4>
        <table>
            <tr>
                <th class="col-md-4">
                    Date Created
                </th>
                <th class="col-md-4">
                    Created By
                </th>
                <th class="col-md-4">
                    Teaser
                </th>
                <th class="col-md-4">
                </th>
            </tr>
        </table>
        <div style="width:700px;height:80px;overflow:auto">
            <table>
                @foreach (var item in Model.TicketComments)
                {
                    <tr>
                        <td class="col-md-4">
                            @item.Created.LocalDateTime
                        </td>
                        <td class="col-md-4">
                            @item.BTUser.DisplayName
                        </td>
                        <td class="col-md-4">
                            @if (item.Comment.Length < 25)
                            {
                                @item.Comment
                            }
                            else
                            {
                                @item.Comment.Substring(0, 24)
                            }
                        </td>
                        <td class="col-md-4">
                            @Html.ActionLink("Details", "Details", "TicketComments", new { id = item.Id, projectid = ViewBag.pid }, null)
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>
    <hr />
    <div class="form-group">
        <h4>Ticket Attachments</h4>
        <table>
            <tr>
                <th class="col-md-4">
                    Created
                </th>
                <th class="col-md-4">
                    Created By
                </th>
                <th class="col-md-4">
                    FileName
                </th>
                <th class="col-md-4">
                </th>
            </tr>
        </table>
        <div style="width:700px;height:80px;overflow:auto">
            <table>
                @foreach (var item in Model.TicketAttachments)
                {
                    <tr>
                        <td class="col-md-4">
                            @item.Created.LocalDateTime
                        </td>
                        <td class="col-md-4">
                            @item.BTUser.DisplayName
                        </td>
                        <td class="col-md-4">
                            <a href="@Url.Content(item.FileUrl)" target=" _blank">@item.FileUrl.Substring(14)</a>
                        </td>
                        <td class="col-md-4">
                            @Html.ActionLink("Details", "Details", "TicketAttachments", new { id = item.Id, projectid = ViewBag.pid }, null)
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>
    <hr />
    <div class="form-group">
        <h4>Ticket History</h4>
        <table>
            <tr>
                <th class="col-md-4">
                    Created
                </th>
                <th class="col-md-4">
                    Created By
                </th>
                <th class="col-md-4">
                    Property
                </th>
                <th class="col-md-4">
                </th>
            </tr>
        </table>
        <div style="width:700px;height:80px;overflow:auto">
            <table>
                @foreach (var item in Model.TicketHistories)
                {
                    <tr>
                        <td class="col-md-4">
                            @item.Changed.LocalDateTime
                        </td>
                        <td class="col-md-4">
                            @item.BTUser.DisplayName
                        </td>
                        <td class="col-md-4">
                            @item.Property
                        </td>
                        <td class="col-md-4">
                            @Html.ActionLink("Details", "Details", "TicketHistories", new { id = item.Id, projectid = ViewBag.pid }, null)
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>
</div>